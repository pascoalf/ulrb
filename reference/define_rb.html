<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Define Rare Biosphere — define_rb • ulrb</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Define Rare Biosphere — define_rb"><meta name="description" content='Classifies taxa in each sample into either "rare", "undetermined" or "abundant". Other classifications are allowed.'><meta property="og:description" content='Classifies taxa in each sample into either "rare", "undetermined" or "abundant". Other classifications are allowed.'><meta property="og:image" content="https://pascoalf.github.io/ulrb/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ulrb</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/eco-analysis.html">Integration of ulrb in a simple microbial ecology workflow</a></li>
    <li><a class="dropdown-item" href="../articles/explore-classifications.html">Alternative classifications with ulrb</a></li>
    <li><a class="dropdown-item" href="../articles/Glossary.html">Glossary</a></li>
    <li><a class="dropdown-item" href="../articles/ulrb-vignet.html">Tutorial to define rare biosphere with ulrb</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pascoalf/ulrb/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Define Rare Biosphere</h1>
      <small class="dont-index">Source: <a href="https://github.com/pascoalf/ulrb/blob/main/R/define_rb.R" class="external-link"><code>R/define_rb.R</code></a></small>
      <div class="d-none name"><code>define_rb.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Classifies taxa in each sample into either "rare", "undetermined" or "abundant". Other classifications are allowed.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">define_rb</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  classification_vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Rare"</span>, <span class="st">"Undetermined"</span>, <span class="st">"Abundant"</span><span class="op">)</span>,</span>
<span>  samples_col <span class="op">=</span> <span class="st">"Sample"</span>,</span>
<span>  abundance_col <span class="op">=</span> <span class="st">"Abundance"</span>,</span>
<span>  simplified <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  automatic <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  index <span class="op">=</span> <span class="st">"Average Silhouette Score"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data.frame with, at least, a column for Abundance and Sample. Additional columns are allowed.</p></dd>


<dt id="arg-classification-vector">classification_vector<a class="anchor" aria-label="anchor" href="#arg-classification-vector"></a></dt>
<dd><p>A vector of strings with the names for each cluster, from lower to higher abundance. Default is c("Rare", "Undetermined", "Abundance").</p></dd>


<dt id="arg-samples-col">samples_col<a class="anchor" aria-label="anchor" href="#arg-samples-col"></a></dt>
<dd><p>String with name of column with sample names.</p></dd>


<dt id="arg-abundance-col">abundance_col<a class="anchor" aria-label="anchor" href="#arg-abundance-col"></a></dt>
<dd><p>String with name of column with abundance values.</p></dd>


<dt id="arg-simplified">simplified<a class="anchor" aria-label="anchor" href="#arg-simplified"></a></dt>
<dd><p>Can be TRUE/FALSE. Default (FALSE) provides an additional column with detailed <code><a href="https://rdrr.io/pkg/cluster/man/pam.html" class="external-link">cluster::pam()</a></code> results
and Silhouette scores. If TRUE, only the Classification result is added to the original input data.</p></dd>


<dt id="arg-automatic">automatic<a class="anchor" aria-label="anchor" href="#arg-automatic"></a></dt>
<dd><p>By default (FALSE), will assume a classification into "Rare", "Undetermined" or "Abundant". If TRUE, then it will automatically select the number of classifications (or k),
based on the index argument.</p></dd>


<dt id="arg-index">index<a class="anchor" aria-label="anchor" href="#arg-index"></a></dt>
<dd><p>Index used to select best k. Can be one of: "Average Silhouette Score", "Davies-Bouldin" or "Calinski-Harabasz".</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Extra arguments.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The input data.frame with extra columns containing the classification and additional metrics (if detailed = TRUE).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><strong>Overview</strong></p>
<p>Function to cluster taxa abundance with partition around medoids algorithm (Kaufman and Rousseuw. 1991).
By default, we propose the division into three clusters (k = 3),
which can be translated into convenient classifications: "rare", "undetermined" and "abundant".
Taxa from the cluster with lowest median abundance corresponds to the "rare biosphere".</p>
<p><strong>The classification vector</strong></p>
<p>The classification vector (argument classification_vector) represents the
different clusters to be used, by ascending order of median abundance.
To change the number of clusters, change the number of elements in the
classification vector, <strong>but order matters!</strong> Depending on the number of clusters used,
you can change the meaning that best applies to your research.</p>
<p>For example, you can use a classification vector with the designations: "very rare", "rare",
"abundant" and "very abundant"; which would apply a k = 4 underneath.
It is possible to use any number of clusters, as long as they are within 2 and
the maximum possible k.</p>
<p>The maximum possible k is the number of different abundance scores observed in a single sample. Note, however,
that we do not recommend any clustering for k &gt; 10
and we also don't recommend k = 2 (we explain in more detail in Pascoal et al., 2024 (in peer review);
and in the vignette <code><a href="../articles/explore-classifications.html">vignette("explore-classifications")</a></code>.</p>
<p><strong>Automatic selection of the number of clusters</strong></p>
<p>To automatically decide the number of clusters (i.e., the value of k), it is possible to do so with the argument <strong>automatic=TRUE</strong>. For details on
complete automation of <code>define_rb()</code>, please see the documentation for <code><a href="suggest_k.html">suggest_k()</a></code>. Briefly, the k with best average Silhouette score
is selected from a range of k values between 3 and 10. It is possible to decide k based on other indices ("Davies-Bouldin" or "Calinsky-Harabasz").</p>
<p>If you want a more fine grained analysis of k values, we provide several functions:</p><ul><li><p><code><a href="evaluate_k.html">evaluate_k()</a></code>;</p></li>
<li><p><code><a href="check_avgSil.html">check_avgSil()</a></code>;</p></li>
<li><p><code><a href="check_DB.html">check_DB()</a></code>;</p></li>
<li><p><code><a href="check_CH.html">check_CH()</a></code>.</p></li>
</ul><p><strong>Verify clustering results</strong></p>
<p>If half of the taxa of any cluster got a Silhouette score below 0.5 in any sample, then a warning is provided.
The warning provides the number of times this issue occurred.
You can inspect other alternatives to reduce the occurrences of a bad clustering,
but it is possible that, in some situations, you just can't find an optimal clustering.</p>
<p>The detailed output gives you access to all of the clustering results:</p><ul><li><p><code>pam_object</code> is a list with the original results from the <code><a href="https://rdrr.io/pkg/cluster/man/pam.html" class="external-link">cluster::pam()</a></code>,
see <code><a href="https://rdrr.io/pkg/cluster/man/pam.html" class="external-link">cluster::pam()</a></code> documentation for more details.</p></li>
<li><p><code>Level</code> is an integer indicating the specific cluster attributed by the <code><a href="https://rdrr.io/pkg/cluster/man/pam.html" class="external-link">cluster::pam()</a></code>
function for each observation. Its order is random.</p></li>
<li><p><code>Silhouette_scores</code> provides the Silhouette score obtained for each
observation, i.e. a score for each taxa.</p></li>
<li><p><code>Cluster_median_abundance</code> provides the median taxa abundance of each cluster.</p></li>
<li><p><code>median_Silhouette</code> provides the median Silhouette score obtained for each cluster.</p></li>
<li><p><code>Evaluation</code> indicates if the silhouette score obtained for a given observation
is below the median Silhouette of its cluster and sample.</p></li>
</ul><p>You can make your own plots and analysis, but we also provide another function,
<code><a href="plot_ulrb.html">plot_ulrb()</a></code>, which illustrates the results obtained.</p>
<p><strong>Partition around medoids (pam)</strong></p>
<p>To calculate k-medoids, we used the partition around medoids (pam)
algorithm, which was described in Chapter 2 of "Finding Groups in Data: An Introduction to Cluster Analysis."
(Kaufman and Rousseeuw, 1991) and implemented by the cluster package with the <code><a href="https://rdrr.io/pkg/cluster/man/pam.html" class="external-link">cluster::pam()</a></code> function.</p>
<p>Briefly, the pam algorithm is divided into two main phases: <strong>build</strong> and <strong>swap</strong>.</p>
<p>The first phase (<strong>build</strong>) selects k observations as cluster representatives. The first
observation selected as representative is the one that minimizes the sum of the dissimilarities to the
remaining observations. The second, third and so on repeat the same process, until k clusters have
been formed.</p>
<p>The <strong>build</strong> steps are:</p>
<p>1 - Propose a centroid with observation, \(i\), which has not been selected as a centroid yet</p>
<p>2 - Calculate the distance between another observation, \(j\), and its most similar
observation, \(D_j\); and calculate the difference with the proposed centroid,
\(i\), i.e., \(d(j,i)\)</p>
<p>3 - If \(d(j,i) &gt; 0\), then calculate its contribution to the centroid:
$$max(D_j - d(j,i),0)$$</p>
<p>4 - Calculate the total gain obtained by \(i\), $$\sum_{j}C_{ji}$$</p>
<p>5 - From all possible centroids, select the one that maximizes the previous total gain obtained,
$$max_i \sum_jC_{ji}$$</p>
<p>6 - Repeat until k observations have been selected as cluster representatives.</p>
<p>The purpose of the next phase, <strong>swap</strong>, is to improve the representatives
for the clusters. The principle is to swap the cluster representative between
all possibilities and calculate the value sum of dissimilarities between each
observation and the closest centroid. The swapping continues until no more improvement is
possible, i.e., when the minimum sum of dissimilarities of the clusters is reached.</p>
<p><strong>Notes</strong>:</p>
<p>Understand that <strong>ulrb</strong> package considers each sample as an independent
community of taxa, which means clustering is also independent across
different samples.
Thus, be aware that you will have clustering results and metrics for each
single sample, which is why we also provide some functions to analyze results across
any number of samples (see: <code><a href="plot_ulrb.html">plot_ulrb()</a></code> for clustering results
and <code><a href="evaluate_k.html">evaluate_k()</a></code> for k selection).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Kaufman, L., &amp; Rousseuw, P. J. (1991). Chapter 2 in book Finding Groups in Data: An Introduction to Cluster Analysis. Biometrics, 47(2), 788.
Pascoal et al. (2024). Definition of the microbial rare biosphere through unsupervised machine learning. Communications Biology, in peer-review.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="suggest_k.html">suggest_k()</a></code>, <code><a href="evaluate_k.html">evaluate_k()</a></code>, <code><a href="plot_ulrb.html">plot_ulrb()</a></code>, <code><a href="https://rdrr.io/pkg/cluster/man/pam.html" class="external-link">cluster::pam()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Sample ID's</span></span></span>
<span class="r-in"><span><span class="va">sample_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ERR2044662"</span>, <span class="st">"ERR2044663"</span>, <span class="st">"ERR2044664"</span>,</span></span>
<span class="r-in"><span>                   <span class="st">"ERR2044665"</span>, <span class="st">"ERR2044666"</span>, <span class="st">"ERR2044667"</span>,</span></span>
<span class="r-in"><span>                   <span class="st">"ERR2044668"</span>, <span class="st">"ERR2044669"</span>, <span class="st">"ERR2044670"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># If data is in wide format, with samples in cols</span></span></span>
<span class="r-in"><span><span class="va">nice_tidy</span> <span class="op">&lt;-</span> <span class="fu"><a href="prepare_tidy_data.html">prepare_tidy_data</a></span><span class="op">(</span><span class="va">nice</span>,</span></span>
<span class="r-in"><span>                               sample_names <span class="op">=</span> <span class="va">sample_names</span>,</span></span>
<span class="r-in"><span>                               samples_in <span class="op">=</span> <span class="st">"cols"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Straightforward with tidy format</span></span></span>
<span class="r-in"><span><span class="fu">define_rb</span><span class="op">(</span><span class="va">nice_tidy</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Joining with `by = join_by(Sample, Level)`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2,177 × 17</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># Groups:   Sample, Classification [27]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Sample    Classification OTU   Domain Phylum Class Order Family Genus Species</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> ERR20446… Rare           OTU_2 sk__A… p__Eu… c__C… <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> ERR20446… Rare           OTU_5 sk__A… p__Eu… c__T… <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> ERR20446… Rare           OTU_6 sk__A… p__Th… <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> ERR20446… Rare           OTU_7 sk__A… p__Th… c__   o__   f__    g__C… <span style="color: #BB0000;">NA</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> ERR20446… Rare           OTU_8 sk__A… p__Th… c__   o__N… <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> ERR20446… Rare           OTU_… sk__A… p__Th… c__   o__N… f__Ni… g__N… <span style="color: #BB0000;">NA</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> ERR20446… Rare           OTU_… sk__B… p__Ac… <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> ERR20446… Rare           OTU_… sk__B… p__Ac… c__A… o__A… <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> ERR20446… Rare           OTU_… sk__B… p__Ac… <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> ERR20446… Rare           OTU_… sk__B… p__Ac… c__A… <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     <span style="color: #BB0000;">NA</span>    <span style="color: #BB0000;">NA</span>     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 2,167 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 7 more variables: Abundance &lt;int&gt;, pam_object &lt;list&gt;, Level &lt;fct&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   Silhouette_scores &lt;dbl&gt;, Cluster_median_abundance &lt;dbl&gt;,</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;">#   median_Silhouette &lt;dbl&gt;, Evaluation &lt;chr&gt;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#Closer look</span></span></span>
<span class="r-in"><span><span class="va">classified_table</span> <span class="op">&lt;-</span> <span class="fu">define_rb</span><span class="op">(</span><span class="va">nice_tidy</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Joining with `by = join_by(Sample, Level)`</span>
<span class="r-in"><span><span class="va">classified_table</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Sample</span>, <span class="va">Abundance</span>, <span class="va">Classification</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># Groups:   Sample, Classification [1]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Sample     Abundance Classification</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> ERR2044662       165 Rare          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> ERR2044662       541 Rare          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> ERR2044662         8 Rare          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> ERR2044662        15 Rare          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> ERR2044662         5 Rare          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> ERR2044662         4 Rare          </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Automatic decision, instead of a predefined definition</span></span></span>
<span class="r-in"><span><span class="fu">define_rb</span><span class="op">(</span><span class="va">nice_tidy</span>, automatic <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Sample</span>, <span class="va">Abundance</span>, <span class="va">Classification</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Automatic option set to TRUE, so classification vector was overwritten</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> K= 3 based on Average Silhouette Score.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Joining with `by = join_by(Sample, Level)`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2,177 × 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># Groups:   Sample, Classification [27]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Sample     Abundance Classification</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> ERR2044662       165 1             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> ERR2044662       541 1             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> ERR2044662         8 1             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> ERR2044662        15 1             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> ERR2044662         5 1             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> ERR2044662         4 1             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> ERR2044662        19 1             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> ERR2044662         1 1             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> ERR2044662        61 1             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> ERR2044662       123 1             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 2,167 more rows</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Automatic decision, using Davies-Bouldin index,</span></span></span>
<span class="r-in"><span><span class="co"># instead of average Silhouette score (default)</span></span></span>
<span class="r-in"><span><span class="fu">define_rb</span><span class="op">(</span><span class="va">nice_tidy</span>, automatic <span class="op">=</span> <span class="cn">TRUE</span>, index <span class="op">=</span> <span class="st">"Davies-Bouldin"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Sample</span>, <span class="va">Abundance</span>, <span class="va">Classification</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Automatic option set to TRUE, so classification vector was overwritten</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> K= 6 based on Davies-Bouldin.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Joining with `by = join_by(Sample, Level)`</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>1 samples got a bad Silhouette score. Consider changing the number of classifications.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> If half the observations within a classification are below 0.5 Silhouette score, we consider that the clustering was 'Bad'.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Check 'Evaluation' collumn for more details.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2,177 × 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># Groups:   Sample, Classification [54]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Sample     Abundance Classification</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> ERR2044662       165 2             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> ERR2044662       541 2             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> ERR2044662       190 2             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> ERR2044662       374 2             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> ERR2044662       308 2             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> ERR2044662       261 2             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> ERR2044662       196 2             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> ERR2044662       576 2             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> ERR2044662       264 2             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> ERR2044662       308 2             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 2,167 more rows</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># User defined classifications</span></span></span>
<span class="r-in"><span><span class="va">user_classifications</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"very rare"</span>,</span></span>
<span class="r-in"><span>                          <span class="st">"rare"</span>,</span></span>
<span class="r-in"><span>                          <span class="st">"undetermined"</span>,</span></span>
<span class="r-in"><span>                          <span class="st">"abundant"</span>,</span></span>
<span class="r-in"><span>                          <span class="st">"very abundant"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">define_rb</span><span class="op">(</span><span class="va">nice_tidy</span>, classification_vector <span class="op">=</span> <span class="va">user_classifications</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Sample</span>, <span class="va">Abundance</span>, <span class="va">Classification</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Joining with `by = join_by(Sample, Level)`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 2,177 × 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># Groups:   Sample, Classification [45]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Sample     Abundance Classification</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> ERR2044662       165 very rare     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> ERR2044662         8 very rare     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> ERR2044662        15 very rare     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> ERR2044662         5 very rare     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> ERR2044662         4 very rare     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> ERR2044662        19 very rare     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> ERR2044662         1 very rare     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> ERR2044662        61 very rare     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> ERR2044662       123 very rare     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> ERR2044662         1 very rare     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 2,167 more rows</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Easy to incorporate in big pipes</span></span></span>
<span class="r-in"><span><span class="co"># Remove Archaea</span></span></span>
<span class="r-in"><span><span class="co"># Remove taxa below 10 reads</span></span></span>
<span class="r-in"><span><span class="co"># Classify according to a different set of classifications</span></span></span>
<span class="r-in"><span><span class="va">nice_tidy</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Domain</span> <span class="op">!=</span> <span class="st">"sk__Archaea"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Abundance</span> <span class="op">&gt;</span> <span class="fl">10</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span> <span class="fu">define_rb</span><span class="op">(</span>classification_vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"very rare"</span>,</span></span>
<span class="r-in"><span>                                     <span class="st">"rare"</span>,</span></span>
<span class="r-in"><span>                                     <span class="st">"abundant"</span>,</span></span>
<span class="r-in"><span>                                     <span class="st">"very abundant"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Sample</span>, <span class="va">Abundance</span>, <span class="va">Classification</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Joining with `by = join_by(Sample, Level)`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 885 × 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># Groups:   Sample, Classification [36]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Sample     Abundance Classification</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> ERR2044662        19 very rare     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> ERR2044662        61 very rare     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> ERR2044662       123 very rare     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> ERR2044662        75 very rare     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> ERR2044662        24 very rare     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> ERR2044662       190 very rare     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> ERR2044662        13 very rare     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> ERR2044662        23 very rare     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> ERR2044662        20 very rare     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> ERR2044662       374 very rare     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 875 more rows</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="co"># An example that summarises results</span></span></span>
<span class="r-in"><span><span class="va">nice_tidy</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Domain</span> <span class="op">!=</span> <span class="st">"sk__Archaea"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Abundance</span> <span class="op">&gt;</span> <span class="fl">10</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span> <span class="fu">define_rb</span><span class="op">(</span>classification_vector <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"very rare"</span>,</span></span>
<span class="r-in"><span>                                     <span class="st">"rare"</span>,</span></span>
<span class="r-in"><span>                                     <span class="st">"abundant"</span>,</span></span>
<span class="r-in"><span>                                     <span class="st">"very abundant"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Sample</span>, <span class="va">Abundance</span>, <span class="va">Classification</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">Sample</span>, <span class="va">Classification</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span></span>
<span class="r-in"><span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>totalAbundance <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Abundance</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Joining with `by = join_by(Sample, Level)`</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> `summarise()` has grouped output by 'Sample'. You can override using the</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> `.groups` argument.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 36 × 3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># Groups:   Sample [9]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Sample     Classification totalAbundance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> ERR2044662 very rare                <span style="text-decoration: underline;">5</span>842</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> ERR2044662 rare                     <span style="text-decoration: underline;">8</span>632</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> ERR2044662 abundant                <span style="text-decoration: underline;">12</span>953</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> ERR2044662 very abundant           <span style="text-decoration: underline;">24</span>242</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> ERR2044663 very rare                <span style="text-decoration: underline;">9</span>555</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> ERR2044663 rare                    <span style="text-decoration: underline;">12</span>622</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> ERR2044663 abundant                <span style="text-decoration: underline;">14</span>846</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> ERR2044663 very abundant           <span style="text-decoration: underline;">28</span>412</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> ERR2044664 very rare                <span style="text-decoration: underline;">3</span>143</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> ERR2044664 rare                     <span style="text-decoration: underline;">6</span>306</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 26 more rows</span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Francisco Pascoal, Paula Branco, Luís Torgo, Rodrigo Costa, Catarina Magalhães.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

