<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Calculates average Silhouette score for a given sample."><title>Check average Silhouette score index — check_avgSil • ulrb</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Check average Silhouette score index — check_avgSil"><meta property="og:description" content="Calculates average Silhouette score for a given sample."><meta property="og:image" content="https://pascoalf.github.io/ulrb/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ulrb</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Glossary.html">Glossary</a>
    <a class="dropdown-item" href="../articles/eco-analysis.html">Integration of ulrb in a simple microbial ecology workflow</a>
    <a class="dropdown-item" href="../articles/explore-classifications.html">Alternative classifications with ulrb</a>
    <a class="dropdown-item" href="../articles/ulrb-vignet.html">Tutorial to define rare biosphere with ulrb</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/pascoalf/ulrb/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Check average Silhouette score index</h1>
      <small class="dont-index">Source: <a href="https://github.com/pascoalf/ulrb/blob/HEAD/R/check_avgSil.R" class="external-link"><code>R/check_avgSil.R</code></a></small>
      <div class="d-none name"><code>check_avgSil.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculates average Silhouette score for a given sample.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">check_avgSil</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  sample_id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  samples_col <span class="op">=</span> <span class="st">"Sample"</span>,</span>
<span>  abundance_col <span class="op">=</span> <span class="st">"Abundance"</span>,</span>
<span>  range <span class="op">=</span> <span class="fl">3</span><span class="op">:</span><span class="fl">10</span>,</span>
<span>  with_plot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>data</dt>
<dd><p>A tibble with, at least, a column for Abundance and Sample. Additional columns are allowed.</p></dd>


<dt>sample_id</dt>
<dd><p>String with name of the sample to apply this function.</p></dd>


<dt>samples_col</dt>
<dd><p>String with name of column with sample names.</p></dd>


<dt>abundance_col</dt>
<dd><p>String with name of column with abundance values.</p></dd>


<dt>range</dt>
<dd><p>The range of values of k to test, default is from 3 to 10.</p></dd>


<dt>with_plot</dt>
<dd><p>If FALSE (default) returns a vector, but if TRUE will return a plot with the scores.</p></dd>


<dt>...</dt>
<dd><p>Extra arguments.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Vector with average Silhouette score index for each pre-specified k.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The average Silhouette score index provides a sense of cluster definition and separation.
It varies between -1 (complete cluster overlap) and 1 (no cluster overlap),
the closest to 1, the better. Thus,
<strong>the k value with highest average Silhouette score is the best k</strong>.
This is the standard metric used by the <strong>ulrb</strong> package for automation of the decision
of k, in functions <code><a href="suggest_k.html">suggest_k()</a></code> and <code><a href="define_rb.html">define_rb()</a></code>.</p>
<p><strong>Note</strong>: The average Silhouette score is different from the common calculation of
the Silhouette index, which provides a score for each observation in a clustering result.
Just like the name says, we are taking the average of all silhouette scores
obtained in a clustering result. In this way we can have a single, comparable
value for each k we test.</p>
<p><strong>Data input</strong></p>
<p>This function takes a data.frame with a column for samples and a column for abundance
(minimum), but can take any number of other columns. It will then filter the specific sample
that you want to analyze. You can also pre-filter for your specific sample, but you still need to
provide the sample ID (sample_id) and the table always needs a column for Sample and another for Abundance
(indicate how you name them with the arguments samples_col and abundance_col).</p>
<p><strong>Output options</strong></p>
<p>The default option returns a vector with CH scores for each k. This is a simple output that can then be used
for other analysis. However, we also provide the option to show a plot (set <code>with_plot = TRUE</code>) with
the CH score for each k.</p>
<p>Note that this function does not plot the classical Silhouette plot of a clustering result.
To do that particular plot, use the function <code><a href="plot_ulrb_silhouette.html">plot_ulrb_silhouette()</a></code> instead.</p>
<p><strong>Explanation of average Silhouette score</strong></p>
<p>To calculate the Silhouette score for a single observation, let:</p><ul><li><p>\(a\) be the mean distance between an observation and all other
observations from the same cluster; and</p></li>
<li><p>\(b\) be the mean distance between all observations in a cluster and the
centroid of the nearest cluster.</p></li>
</ul><p>The silhouette score (Sil), is given by:</p>
<p>$$Sil = \frac{(b-a)}{max(a,b)}$$</p>
<p>Once you have the Silhouette score for all observations in a clustering result, just
take the simple mean and get the average Silhouette score.</p>
<p><strong>Silhouette score intuition</strong></p>
<p>From the above formula, \(Sil = \frac{(b-a)}{max(a,b)}\), it is clear that,
for a given observation:</p><ul><li><p>if \(a &gt; b\), the Silhouette score approaches <strong>1</strong>; this means that the
distance between an observation and its own cluster is larger than the
distance to the nearest different cluster. This is the distance that must be
maximized so that all points in a cluster are more similar with each other,
than they are with other clusters.</p></li>
<li><p>if \(a = b\), then the Silhouette score is <strong>0</strong>; this means that the distance
between the observation and its own cluster is equivalent to distance between
the nearest different cluster.</p></li>
<li><p>if \(a &lt; b\), then the Silhouette score approaches <strong>-1</strong>; in this
situation, an observation is nearer the nearest different cluster,
than it is to its own cluster. Thus, a negative score indicates that the observation
is not in the correct cluster.</p></li>
</ul><p><strong>average Silhouette score intuition</strong></p>
<p>If we take the average of the Silhouette score obtained for each observation in
a clustering result, then we have the ability to compare the overall success of that
clustering with another clustering. Thus, if we compare the average Silhouette
score across different k values, i.e. different number of clusters, we can
select the k with highest average Silhouette score.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Rousseeuw, P. J. (1987). Silhouettes: A graphical aid to the interpretation and validation of cluster analysis. Journal of Computational and Applied Mathematics, 20(C), 53–65.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="define_rb.html">define_rb()</a></code>, <code><a href="suggest_k.html">suggest_k()</a></code>, <code><a href="https://rdrr.io/pkg/cluster/man/pam.html" class="external-link">cluster::pam()</a></code>, <code><a href="https://rdrr.io/pkg/cluster/man/silhouette.html" class="external-link">cluster::silhouette()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Just scores</span></span></span>
<span class="r-in"><span><span class="fu">check_avgSil</span><span class="op">(</span><span class="va">nice_tidy</span>, sample_id <span class="op">=</span> <span class="st">"ERR2044662"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.9521452 0.8820316 0.8561774 0.8398216 0.8479872 0.7843358 0.7740169</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [8] 0.7701163</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># To change range</span></span></span>
<span class="r-in"><span><span class="fu">check_avgSil</span><span class="op">(</span><span class="va">nice_tidy</span>, sample_id <span class="op">=</span> <span class="st">"ERR2044662"</span>, range <span class="op">=</span> <span class="fl">4</span><span class="op">:</span><span class="fl">11</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.8820316 0.8561774 0.8398216 0.8479872 0.7843358 0.7740169 0.7701163</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [8] 0.7629755</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># To see a simple plot</span></span></span>
<span class="r-in"><span><span class="fu">check_avgSil</span><span class="op">(</span><span class="va">nice_tidy</span>, sample_id <span class="op">=</span> <span class="st">"ERR2044662"</span>, range <span class="op">=</span> <span class="fl">4</span><span class="op">:</span><span class="fl">11</span>, with_plot<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="check_avgSil-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Francisco Pascoal, Paula Branco, Luís Torgo, Rodrigo Costa, Catarina Magalhães.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

