<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Unsupervised Learning Based Definition of Microbial Rare Biosphere • ulrb</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Unsupervised Learning Based Definition of Microbial Rare Biosphere">
<meta name="description" content="A tool to define rare biosphere. ulrb solves the problem of the definition of rarity by replacing arbitrary thresholds with an unsupervised machine learning algorithm (partitioning around medoids, or k-medoids). This algorithm works for any type of microbiome data, provided there is a species abundance table. For validation of this method to different species abundance tables see Pascoal et al, 2024 (in peer-review). This method also works for non-microbiome data.">
<meta property="og:description" content="A tool to define rare biosphere. ulrb solves the problem of the definition of rarity by replacing arbitrary thresholds with an unsupervised machine learning algorithm (partitioning around medoids, or k-medoids). This algorithm works for any type of microbiome data, provided there is a species abundance table. For validation of this method to different species abundance tables see Pascoal et al, 2024 (in peer-review). This method also works for non-microbiome data.">
<meta property="og:image" content="https://pascoalf.github.io/ulrb/logo.png">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">ulrb</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/eco-analysis.html">Integration of ulrb in a simple microbial ecology workflow</a></li>
    <li><a class="dropdown-item" href="articles/explore-classifications.html">Alternative classifications with ulrb</a></li>
    <li><a class="dropdown-item" href="articles/Glossary.html">Glossary</a></li>
    <li><a class="dropdown-item" href="articles/ulrb-vignet.html">Tutorial to define rare biosphere with ulrb</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pascoalf/ulrb/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.png" class="logo" alt=""><h1 id="ulrb">ulrb<a class="anchor" aria-label="anchor" href="#ulrb"></a>
</h1>
</div>
<!-- badges: start -->

<p>The R package <strong>ulrb</strong> stands for <strong>Unsupervised Learning Based Definition of Microbial Rare Biosphere</strong>. As the name suggests, it applies unsupervised learning principles to define the rare biosphere.</p>
<p>More specifically, the partitioning around medoids (k-medoids) algorithm is used to divide taxa within a sample into clusters. The clusters are then ordered based on a user-defined classification vector. By default, our method classifies all taxa in: “rare”, “undetermined” or “abundant”. In alternative, the user can change the number of classifications. To do so, ulrb includes functions to help the user decide the number of clusters (k), but it is also possible for ulrb to automatically decide the number of clusters (equivalent to the number of classifications). Besides clustering, ulrb includes functions to help evaluate the clustering quality (e.g. average Silhouette score).</p>
<p>For more details on the R functions used and data wrangling please see the package documentation.</p>
<p>For tutorials and documentation of the <strong>ulrb</strong> package, visit our website: link.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>To install the last stable version, use:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"ulrb"</span><span class="op">)</span></span></code></pre></div>
<p>If you want to install the last version available on GitHub, use:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install.packages("devtools")</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"pascoalf/ulrb"</span><span class="op">)</span></span></code></pre></div>
<p>We are working on a CRAN publication. We will then provide instructions for CRAN installation.</p>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>This is a basic example which shows you how to use ulrb to divide taxa into three classifications (rare, undetermined and abundant):</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pascoalf.github.io/ulrb/">ulrb</a></span><span class="op">)</span></span>
<span><span class="co">## basic example</span></span>
<span><span class="fu"><a href="reference/define_rb.html">define_rb</a></span><span class="op">(</span><span class="va">nice_tidy</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(Sample, Level)`</span></span>
<span><span class="co">#&gt; # A tibble: 2,177 × 17</span></span>
<span><span class="co">#&gt; # Groups:   Sample, Classification [27]</span></span>
<span><span class="co">#&gt;    Sample    Classification OTU   Domain Phylum Class Order Family Genus Species</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;     &lt;fct&gt;          &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;  </span></span>
<span><span class="co">#&gt;  1 ERR20446… Rare           OTU_2 sk__A… p__Eu… c__C… &lt;NA&gt;  &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;   </span></span>
<span><span class="co">#&gt;  2 ERR20446… Rare           OTU_5 sk__A… p__Eu… c__T… &lt;NA&gt;  &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;   </span></span>
<span><span class="co">#&gt;  3 ERR20446… Rare           OTU_6 sk__A… p__Th… &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;   </span></span>
<span><span class="co">#&gt;  4 ERR20446… Rare           OTU_7 sk__A… p__Th… c__   o__   f__    g__C… &lt;NA&gt;   </span></span>
<span><span class="co">#&gt;  5 ERR20446… Rare           OTU_8 sk__A… p__Th… c__   o__N… &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;   </span></span>
<span><span class="co">#&gt;  6 ERR20446… Rare           OTU_… sk__A… p__Th… c__   o__N… f__Ni… g__N… &lt;NA&gt;   </span></span>
<span><span class="co">#&gt;  7 ERR20446… Rare           OTU_… sk__B… p__Ac… &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;   </span></span>
<span><span class="co">#&gt;  8 ERR20446… Rare           OTU_… sk__B… p__Ac… c__A… o__A… &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;   </span></span>
<span><span class="co">#&gt;  9 ERR20446… Rare           OTU_… sk__B… p__Ac… &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;   </span></span>
<span><span class="co">#&gt; 10 ERR20446… Rare           OTU_… sk__B… p__Ac… c__A… &lt;NA&gt;  &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;   </span></span>
<span><span class="co">#&gt; # ℹ 2,167 more rows</span></span>
<span><span class="co">#&gt; # ℹ 7 more variables: Abundance &lt;int&gt;, pam_object &lt;list&gt;, Level &lt;fct&gt;,</span></span>
<span><span class="co">#&gt; #   Silhouette_scores &lt;dbl&gt;, Cluster_median_abundance &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   median_Silhouette &lt;dbl&gt;, Evaluation &lt;chr&gt;</span></span></code></pre></div>
<p>With ulrb, you can also format your original abundance table, get an automatic number of clusters and plot the results:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># nice is an OTU table in wide format</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">nice</span><span class="op">)</span></span>
<span><span class="co">#&gt;   ERR2044662 ERR2044663 ERR2044664 ERR2044665 ERR2044666 ERR2044667 ERR2044668</span></span>
<span><span class="co">#&gt; 1        165        323         51         70        134        216          0</span></span>
<span><span class="co">#&gt; 2          0          0          1          0          0          1          0</span></span>
<span><span class="co">#&gt; 3          0          0          1          2          2          6          0</span></span>
<span><span class="co">#&gt; 4        541       1018        351        115        241       1633        177</span></span>
<span><span class="co">#&gt; 5          8          5         41         15         14        146          0</span></span>
<span><span class="co">#&gt; 6         15         31        590        133        174       1814         12</span></span>
<span><span class="co">#&gt;   ERR2044669 ERR2044670   OTU      Domain            Phylum</span></span>
<span><span class="co">#&gt; 1         11          0 OTU_2 sk__Archaea  p__Euryarchaeota</span></span>
<span><span class="co">#&gt; 2          0          0 OTU_3 sk__Archaea  p__Euryarchaeota</span></span>
<span><span class="co">#&gt; 3          0          0 OTU_4 sk__Archaea  p__Euryarchaeota</span></span>
<span><span class="co">#&gt; 4       1371          7 OTU_5 sk__Archaea  p__Euryarchaeota</span></span>
<span><span class="co">#&gt; 5         14          0 OTU_6 sk__Archaea p__Thaumarchaeota</span></span>
<span><span class="co">#&gt; 6        173          2 OTU_7 sk__Archaea p__Thaumarchaeota</span></span>
<span><span class="co">#&gt;                       Class                       Order Family</span></span>
<span><span class="co">#&gt; 1 c__Candidatus_Poseidoniia                        &lt;NA&gt;   &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 2 c__Candidatus_Poseidoniia o__Candidatus_Poseidoniales    f__</span></span>
<span><span class="co">#&gt; 3           c__Halobacteria          o__Halobacteriales   &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4         c__Thermoplasmata                        &lt;NA&gt;   &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 5                      &lt;NA&gt;                        &lt;NA&gt;   &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 6                       c__                         o__    f__</span></span>
<span><span class="co">#&gt;                            Genus                                        Species</span></span>
<span><span class="co">#&gt; 1                           &lt;NA&gt;                                           &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 2                            g__ s__Marine_group_II_euryarchaeote_REDSEA-S03_B6</span></span>
<span><span class="co">#&gt; 3                           &lt;NA&gt;                                           &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 4                           &lt;NA&gt;                                           &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 5                           &lt;NA&gt;                                           &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 6 g__Candidatus_Nitrosopelagicus                                           &lt;NA&gt;</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># first, we tidy the "nice" OTU table</span></span>
<span><span class="va">sample_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ERR2044662"</span>, <span class="st">"ERR2044663"</span>, <span class="st">"ERR2044664"</span>,</span>
<span>                   <span class="st">"ERR2044665"</span>, <span class="st">"ERR2044666"</span>, <span class="st">"ERR2044667"</span>,</span>
<span>                   <span class="st">"ERR2044668"</span>, <span class="st">"ERR2044669"</span>, <span class="st">"ERR2044670"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># If data is in wide format, with samples in cols</span></span>
<span><span class="va">nice_tidy</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/prepare_tidy_data.html">prepare_tidy_data</a></span><span class="op">(</span><span class="va">nice</span>,</span>
<span>                               sample_names <span class="op">=</span> <span class="va">sample_names</span>,</span>
<span>                               samples_in <span class="op">=</span> <span class="st">"cols"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># second, we apply ulrb algorithm in automatic setting</span></span>
<span><span class="va">nice_classification_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/define_rb.html">define_rb</a></span><span class="op">(</span><span class="va">nice_tidy</span><span class="op">)</span></span>
<span><span class="co">#&gt; Joining with `by = join_by(Sample, Level)`</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># third, we plot microbial community and the quality of k-medoids clustering</span></span>
<span><span class="fu"><a href="reference/plot_ulrb.html">plot_ulrb</a></span><span class="op">(</span><span class="va">nice_classification_results</span>, taxa_col <span class="op">=</span> <span class="st">"OTU"</span>, plot_all <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-4-1.png" width="100%"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># In case you want to inspect the result of a particular sample, do:</span></span>
<span><span class="fu"><a href="reference/plot_ulrb.html">plot_ulrb</a></span><span class="op">(</span><span class="va">nice_classification_results</span>, taxa_col <span class="op">=</span> <span class="st">"OTU"</span>, </span>
<span>          sample_id <span class="op">=</span> <span class="st">"ERR2044662"</span>, plot_all <span class="op">=</span> <span class="cn">FALSE</span>, log_scaled <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-4-2.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="how-to-cite-ulrb">How to cite ulrb<a class="anchor" aria-label="anchor" href="#how-to-cite-ulrb"></a>
</h2>
<p>Pascoal, F., Branco, P., Torgo, L., Costa, R., &amp; Magalhães, C. (2025). Definition of the microbial rare biosphere through unsupervised machine learning. Communications Biology.</p>
<p>Pascoal, F., Costa, R., Torgo, L., Magalhães, C., &amp; Branco, P. (2025). ulrb: an R Package to Automatically Define Rare Taxa. Ecological Informatics (in Peer-Review).</p>
<p>To cite this GitHub repository (v0.1.6): Francisco Pascoal. (2025). pascoalf/ulrb: v0.1.6 (v0.1.6). Zenodo. <a href="https://doi.org/10.5281/zenodo.14922442" class="external-link uri">https://doi.org/10.5281/zenodo.14922442</a></p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=ulrb" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/pascoalf/ulrb/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/pascoalf/ulrb/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing ulrb</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Francisco Pascoal <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-2315-358X" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Paula Branco <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-9917-3694" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Luís Torgo <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-6892-8871" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Rodrigo Costa <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-5932-4101" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Catarina Magalhães <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0001-9576-2398" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/pascoalf/ulrb/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/pascoalf/ulrb/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://cran.r-project.org/package=ulrb" class="external-link"><img src="https://www.r-pkg.org/badges/version/ulrb" alt="CRAN_Status_Badge"></a></li>
<li><a href="https://github.com/pascoalf/ulrb/actions/workflows/test-coverage.yaml" class="external-link"><img src="https://github.com/pascoalf/ulrb/actions/workflows/test-coverage.yaml/badge.svg" alt="test-coverage"></a></li>
<li><a href="http://perso.crans.org/besson/LICENSE.html" class="external-link"><img src="https://img.shields.io/badge/License-GPLv3-blue.svg" alt="GPLv3 license"></a></li>
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="https://img.shields.io/badge/lifecycle-stable-brightgreen.svg" alt="Lifecycle: stable"></a></li>
<li><a href="https://doi.org/10.5281/zenodo.14922441" class="external-link"><img src="https://zenodo.org/badge/584780462.svg" alt="DOI"></a></li>
<li><a href="https://cran.rstudio.com/web/packages/urlb/" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/grand-total/ulrb" alt="Downloads"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Francisco Pascoal, Paula Branco, Luís Torgo, Rodrigo Costa, Catarina Magalhães.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
